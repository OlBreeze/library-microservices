
ĞŸÑ€Ğ¸ Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ñ–Ğ¹ Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ– ĞºĞ¾Ğ¶ĞµĞ½ ÑĞµÑ€Ğ²Ñ–Ñ Ğ¼Ğ°Ñ” **ÑĞ²Ğ¾Ñ Ğ²Ğ»Ğ°ÑĞ½Ñƒ Ğ°Ğ´Ğ¼Ñ–Ğ½ĞºÑƒ** Ğ½Ğ° ÑĞ²Ğ¾Ñ”Ğ¼Ñƒ Ğ¿Ğ¾Ñ€Ñ‚Ñ–.

## ğŸ—ï¸ ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¸:

```
ğŸ“¦ ĞœÑ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ° Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ±Ñ–Ğ±Ğ»Ñ–Ğ¾Ñ‚ĞµĞºĞ¸

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ API Gateway (Ğ¾Ğ¿Ñ†Ñ–Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)                           â”‚
â”‚  http://localhost:8000                                  â”‚
â”‚  - ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ñ–Ñ Ğ·Ğ°Ğ¿Ğ¸Ñ‚Ñ–Ğ² Ğ´Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ²                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” Auth Service     â”‚      â”‚  ğŸ“š Books Service    â”‚
â”‚  Port: 8001          â”‚      â”‚  Port: 8002          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Database: users.db  â”‚      â”‚  Database: books.db  â”‚
â”‚                      â”‚      â”‚                      â”‚
â”‚  Admin:              â”‚      â”‚  Admin:              â”‚
â”‚  localhost:8001/adminâ”‚      â”‚  localhost:8002/adminâ”‚
â”‚                      â”‚      â”‚                      â”‚
â”‚  API:                â”‚      â”‚  API:                â”‚
â”‚  /api/auth/register/ â”‚      â”‚  /api/books/         â”‚
â”‚  /api/auth/login/    â”‚      â”‚  /api/books/{id}/    â”‚
â”‚  /api/auth/profile/  â”‚      â”‚  /api/books/search/  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚Ñƒ:

```
library_microservices/
â”œâ”€â”€ auth_service/              # Ğ¡ĞµÑ€Ğ²Ñ–Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ñ–ĞºĞ°Ñ†Ñ–Ñ—
â”‚   â”œâ”€â”€ manage.py
â”‚   â”œâ”€â”€ auth_service/
â”‚   â”‚   â”œâ”€â”€ settings.py        # PORT = 8001
â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â””â”€â”€ wsgi.py
â”‚   â”œâ”€â”€ authentication/        # App Ğ´Ğ»Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ñ–ĞºĞ°Ñ†Ñ–Ñ—
â”‚   â”‚   â”œâ”€â”€ models.py          # User (Ğ°Ğ±Ğ¾ custom User)
â”‚   â”‚   â”œâ”€â”€ admin.py           # âœ… ĞĞ´Ğ¼Ñ–Ğ½ĞºĞ° ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ñ–Ğ²
â”‚   â”‚   â”œâ”€â”€ serializers.py
â”‚   â”‚   â””â”€â”€ views.py
â”‚   â”œâ”€â”€ db_users.sqlite3       # Ğ‘Ğ°Ğ·Ğ° ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ñ–Ğ²
â”‚   â””â”€â”€ requirements.txt
â”‚
â””â”€â”€ books_service/             # Ğ¡ĞµÑ€Ğ²Ñ–Ñ ĞºĞ½Ğ¸Ğ³
    â”œâ”€â”€ manage.py
    â”œâ”€â”€ books_service/
    â”‚   â”œâ”€â”€ settings.py        # PORT = 8002
    â”‚   â”œâ”€â”€ urls.py
    â”‚   â””â”€â”€ wsgi.py
    â”œâ”€â”€ books/                 # App Ğ´Ğ»Ñ ĞºĞ½Ğ¸Ğ³
    â”‚   â”œâ”€â”€ models.py          # Book (user_id ÑĞº Ñ‡Ğ¸ÑĞ»Ğ¾)
    â”‚   â”œâ”€â”€ admin.py           # âœ… ĞĞ´Ğ¼Ñ–Ğ½ĞºĞ° ĞºĞ½Ğ¸Ğ³
    â”‚   â”œâ”€â”€ serializers.py
    â”‚   â””â”€â”€ views.py
    â”œâ”€â”€ db_books.sqlite3       # Ğ‘Ğ°Ğ·Ğ° ĞºĞ½Ğ¸Ğ³
    â””â”€â”€ requirements.txt
```

## ğŸ”§ ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ ĞºĞ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ:

### 1ï¸âƒ£ Auth Service (Port 8001)

**`auth_service/settings.py`:**
```python
# Database
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db_users.sqlite3',  # ĞĞºÑ€ĞµĞ¼Ğ° Ğ‘Ğ”!
    }
}

# Allowed hosts
ALLOWED_HOSTS = ['localhost', '127.0.0.1']

# JWT settings
SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(hours=1),
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
    'SIGNING_KEY': 'SHARED_SECRET_KEY_123',  # âš ï¸ ĞĞ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ° Ğ´Ğ»Ñ Ğ¾Ğ±Ğ¾Ñ… ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ²!
}
```

**`authentication/admin.py`:**
```python
from django.contrib import admin
from django.contrib.auth.models import User

@admin.register(User)
class UserAdmin(admin.ModelAdmin):
    list_display = ['id', 'username', 'email', 'is_staff', 'date_joined']
    search_fields = ['username', 'email']
    list_filter = ['is_staff', 'is_active', 'date_joined']

admin.site.site_header = "ğŸ” Auth Service Admin"
admin.site.site_title = "Auth Admin"
```

**Ğ—Ğ°Ğ¿ÑƒÑĞº:**
```bash
cd auth_service
python manage.py runserver 8001
```

**Ğ”Ğ¾ÑÑ‚ÑƒĞ¿:**
- API: `http://localhost:8001/api/auth/`
- Admin: `http://localhost:8001/admin/`

---

### 2ï¸âƒ£ Books Service (Port 8002)

**`books_service/settings.py`:**
```python
# Database
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db_books.sqlite3',  # ĞĞºÑ€ĞµĞ¼Ğ° Ğ‘Ğ”!
    }
}

# JWT settings (Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ñ–Ğ´Ğ°Ñ†Ñ–Ñ— Ñ‚Ğ¾ĞºĞµĞ½Ñ–Ğ²)
SIMPLE_JWT = {
    'SIGNING_KEY': 'SHARED_SECRET_KEY_123',  # âš ï¸ Ğ¢Ğ° Ğ¶ ÑĞ°Ğ¼Ğ°!
}

# REST Framework
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ),
}
```

**`books/models.py`:**
```python
from django.db import models

class Book(models.Model):
    """ĞœĞ¾Ğ´ĞµĞ»ÑŒ ĞºĞ½Ğ¸Ğ³Ğ¸ Ğ±ĞµĞ· ForeignKey Ğ´Ğ¾ User (Ğ¼Ñ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ° Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)."""
    title = models.CharField(max_length=255)
    author = models.CharField(max_length=255)
    genre = models.CharField(max_length=100)
    publication_year = models.PositiveIntegerField()
    user_id = models.IntegerField()  # âš ï¸ ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ ID, Ğ½Ğµ ForeignKey!
    created_at = models.DateTimeField(auto_now_add=True)
    
    def __str__(self):
        return f"{self.title} (User ID: {self.user_id})"
```

**`books/admin.py`:**
```python
from django.contrib import admin
from .models import Book

@admin.register(Book)
class BookAdmin(admin.ModelAdmin):
    list_display = ['id', 'title', 'author', 'genre', 'publication_year', 'user_id', 'created_at']
    list_editable = ['title', 'author', 'genre', 'publication_year']
    search_fields = ['title', 'author', 'genre']
    list_filter = ['genre', 'publication_year']
    
    def get_user_info(self, obj):
        """ĞŸĞ¾ĞºĞ°Ğ·ÑƒÑ” Ñ–Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ñ–Ñ Ğ¿Ñ€Ğ¾ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° Ñ‡ĞµÑ€ĞµĞ· API Auth Service."""
        import requests
        try:
            response = requests.get(f'http://localhost:8001/api/users/{obj.user_id}/')
            if response.status_code == 200:
                user_data = response.json()
                return f"{user_data['username']} ({user_data['email']})"
        except:
            pass
        return f"User ID: {obj.user_id}"
    
    get_user_info.short_description = 'ĞšĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡'

admin.site.site_header = "ğŸ“š Books Service Admin"
admin.site.site_title = "Books Admin"
```

**Ğ—Ğ°Ğ¿ÑƒÑĞº:**
```bash
cd books_service
python manage.py runserver 8002
```

**Ğ”Ğ¾ÑÑ‚ÑƒĞ¿:**
- API: `http://localhost:8002/api/books/`
- Admin: `http://localhost:8002/admin/`

---

## ğŸ” Ğ¯Ğº Ğ¿Ñ€Ğ°Ñ†ÑÑ” Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ñ–ĞºĞ°Ñ†Ñ–Ñ Ğ¼Ñ–Ğ¶ ÑĞµÑ€Ğ²Ñ–ÑĞ°Ğ¼Ğ¸:

```python
# 1. ĞšĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡ Ğ»Ğ¾Ğ³Ñ–Ğ½ÑƒÑ”Ñ‚ÑŒÑÑ Ğ² Auth Service
POST http://localhost:8001/api/auth/token/
{
  "username": "gala",
  "password": "password123"
}

Response:
{
  "access": "eyJ0eXAiOiJKV1QiLCJh...",  # JWT Ñ‚Ğ¾ĞºĞµĞ½
  "refresh": "eyJ0eXAiOiJKV1QiLC..."
}

# 2. ĞšĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ” Ñ‚Ğ¾ĞºĞµĞ½ Ğ´Ğ»Ñ Books Service
GET http://localhost:8002/api/books/
Headers: Authorization: Bearer eyJ0eXAiOiJKV1QiLCJh...

# 3. Books Service Ğ²Ğ°Ğ»Ñ–Ğ´ÑƒÑ” Ñ‚Ğ¾ĞºĞµĞ½ (Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑÑ‡Ğ¸ Ñ‚Ñƒ ÑĞ°Ğ¼Ñƒ SECRET_KEY)
# 4. Ğ— Ñ‚Ğ¾ĞºĞµĞ½Ñƒ Ğ´Ñ–ÑÑ‚Ğ°Ñ”Ñ‚ÑŒÑÑ user_id
# 5. ĞšĞ½Ğ¸Ğ³Ğ° Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ñ”Ñ‚ÑŒÑÑ Ğ· Ñ†Ğ¸Ğ¼ user_id
```

## ğŸ¯ ĞŸĞµÑ€ĞµĞ²Ğ°Ğ³Ğ¸ Ñ‚Ğ°ĞºĞ¾Ñ— Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¸:

### âœ… ĞŸĞµÑ€ĞµĞ²Ğ°Ğ³Ğ¸:
1. **ĞĞµĞ·Ğ°Ğ»ĞµĞ¶Ğ½Ğµ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±ÑƒĞ²Ğ°Ğ½Ğ½Ñ** - Books Service Ğ¼Ğ¾Ğ¶Ğµ Ğ¼Ğ°Ñ‚Ğ¸ 10 Ñ–Ğ½ÑÑ‚Ğ°Ğ½ÑÑ–Ğ², Auth - 2
2. **Ğ Ñ–Ğ·Ğ½Ñ– Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ—** - Auth Ğ½Ğ° Django, Books Ğ½Ğ° FastAPI (ÑĞºÑ‰Ğ¾ Ñ‚Ñ€ĞµĞ±Ğ°)
3. **ĞĞºÑ€ĞµĞ¼Ñ– ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸** - ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° auth Ğ½Ğµ Ñ‡Ñ–Ğ¿Ğ°Ñ” ĞºĞ¾Ğ´ books
4. **Ğ‘ĞµĞ·Ğ¿ĞµĞºĞ°** - ÑĞºÑ‰Ğ¾ Ğ·Ğ»Ğ°Ğ¼Ğ°ÑÑ‚ÑŒ Books Service, ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ñ– Ğ·Ğ°Ğ»Ğ¸ÑˆĞ°ÑÑ‚ÑŒÑÑ Ğ² Ğ±ĞµĞ·Ğ¿ĞµÑ†Ñ–
5. **Ğ›ĞµĞ³ÑˆĞµ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ—Ñ‚Ğ¸** - Ğ¾Ğ½Ğ¾Ğ²Ğ¸Ğ² Ñ‚Ñ–Ğ»ÑŒĞºĞ¸ Books Service, Auth Ğ½Ğµ Ñ‡Ñ–Ğ¿Ğ°Ñ”Ñˆ

### âŒ ĞĞµĞ´Ğ¾Ğ»Ñ–ĞºĞ¸:
1. **Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ñ–ÑˆĞ° Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°** - Ñ‚Ñ€ĞµĞ±Ğ° ĞºĞµÑ€ÑƒĞ²Ğ°Ñ‚Ğ¸ ĞºÑ–Ğ»ÑŒĞºĞ¾Ğ¼Ğ° ÑĞµÑ€Ğ²Ñ–ÑĞ°Ğ¼Ğ¸
2. **ĞĞµĞ¼Ğ°Ñ” ForeignKey** - `user_id` Ñ†Ğµ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ¾, Ğ½Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ° `.user.username`
3. **Ğ”Ğ¾Ğ´Ğ°Ñ‚ĞºĞ¾Ğ²Ñ– HTTP Ğ·Ğ°Ğ¿Ğ¸Ñ‚Ğ¸** - Ñ‰Ğ¾Ğ± Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ğ´Ğ°Ğ½Ñ– ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
4. **Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ñ–Ñ—** - ÑĞºĞ»Ğ°Ğ´Ğ½Ğ¾ Ñ€Ğ¾Ğ±Ğ¸Ñ‚Ğ¸ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ñ–Ñ— Ğ¼Ñ–Ğ¶ ÑĞµÑ€Ğ²Ñ–ÑĞ°Ğ¼Ğ¸
5. **Ğ”Ğ²Ñ– Ğ°Ğ´Ğ¼Ñ–Ğ½ĞºĞ¸** - Ñ‚Ñ€ĞµĞ±Ğ° Ğ»Ğ¾Ğ³Ñ–Ğ½Ğ¸Ñ‚Ğ¸ÑÑŒ Ğ² ĞºĞ¾Ğ¶Ğ½Ñƒ Ğ¾ĞºÑ€ĞµĞ¼Ğ¾

## ğŸš€ API Gateway (Ğ¾Ğ¿Ñ†Ñ–Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾):

ĞœĞ¾Ğ¶Ğ½Ğ° Ğ´Ğ¾Ğ´Ğ°Ñ‚Ğ¸ **Ñ”Ğ´Ğ¸Ğ½Ñƒ Ñ‚Ğ¾Ñ‡ĞºÑƒ Ğ²Ñ…Ğ¾Ğ´Ñƒ**:

```python
# api_gateway/urls.py (Port 8000)
from django.urls import path, include
import requests

def proxy_auth(request, path):
    """ĞŸÑ€Ğ¾ĞºÑÑ– Ğ´Ğ»Ñ Auth Service."""
    url = f'http://localhost:8001/{path}'
    response = requests.request(
        method=request.method,
        url=url,
        headers=request.headers,
        data=request.body
    )
    return HttpResponse(response.content, status=response.status_code)

def proxy_books(request, path):
    """ĞŸÑ€Ğ¾ĞºÑÑ– Ğ´Ğ»Ñ Books Service."""
    url = f'http://localhost:8002/{path}'
    # ... Ğ°Ğ½Ğ°Ğ»Ğ¾Ğ³Ñ–Ñ‡Ğ½Ğ¾

urlpatterns = [
    path('api/auth/<path:path>', proxy_auth),
    path('api/books/<path:path>', proxy_books),
]
```

Ğ¢ĞµĞ¿ĞµÑ€ Ğ²ÑÑ– Ğ·Ğ°Ğ¿Ğ¸Ñ‚Ğ¸ Ğ¹Ğ´ÑƒÑ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· `localhost:8000`, Ğ°Ğ»Ğµ Ğ²Ñ–Ğ½ Ğ¿ĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ” Ñ—Ñ… Ğ½Ğ° Ğ²Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´Ğ½Ñ– ÑĞµÑ€Ğ²Ñ–ÑĞ¸.

## ğŸ“Š ĞŸÑ–Ğ´ÑÑƒĞ¼Ğ¾Ğº:

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞœĞ¾Ğ½Ğ¾Ğ»Ñ–Ñ‚Ğ½Ğ° Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° | ĞœÑ–ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ñ–ÑĞ½Ğ° |
|----------|----------------------|---------------|
| **ĞĞ´Ğ¼Ñ–Ğ½ĞºĞ°** | ĞĞ´Ğ½Ğ° Ğ½Ğ° `localhost:8000/admin/` | Ğ”Ğ²Ñ–: `8001/admin/` Ñ‚Ğ° `8002/admin/` |
| **Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ¸Ñ…** | ĞĞ´Ğ½Ğ° ÑĞ¿Ñ–Ğ»ÑŒĞ½Ğ° | Ğ”Ğ²Ñ– Ğ¾ĞºÑ€ĞµĞ¼Ñ– |
| **ForeignKey** | âœ… ĞœĞ¾Ğ¶Ğ½Ğ° `book.user.username` | âŒ Ğ¢Ñ–Ğ»ÑŒĞºĞ¸ `book.user_id` |
| **Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ñ–ÑÑ‚ÑŒ** | ğŸŸ¢ ĞŸÑ€Ğ¾ÑÑ‚Ğ° | ğŸ”´ Ğ¡ĞºĞ»Ğ°Ğ´Ğ½Ğ° |
| **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±ÑƒĞ²Ğ°Ğ½Ğ½Ñ** | ğŸ”´ Ğ’Ğ°Ğ¶ĞºĞ¾ | ğŸŸ¢ Ğ›ĞµĞ³ĞºĞ¾ |

# Django REST Framework JWT Authentication Ñ€Ğ¾Ğ±Ğ¸Ñ‚ÑŒ Ñ†Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾:

# 1. ĞÑ‚Ñ€Ğ¸Ğ¼ÑƒÑ” Ñ‚Ğ¾ĞºĞµĞ½ Ğ· Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ°
token = request.headers.get('Authorization')  # "Bearer eyJhbGci..."

# 2. Ğ’Ğ¸Ğ´Ğ°Ğ»ÑÑ” "Bearer "
token = token.replace('Bearer ', '')  # "eyJhbGci..."

# 3. Ğ”ĞµĞºĞ¾Ğ´ÑƒÑ” Ñ‚Ğ¾ĞºĞµĞ½ Ğ· SECRET_KEY

```python
try:
    payload = jwt.decode(
        token,
        settings.SIMPLE_JWT['SIGNING_KEY'],  # Ğ¢Ğ¾Ğ¹ ÑĞ°Ğ¼Ğ¸Ğ¹ SECRET_KEY!
        algorithms=[settings.SIMPLE_JWT['ALGORITHM']]
    )
    # payload = {"user_id": 3, "exp": 1762093974, ...}
    
    # 4. Ğ”Ñ–ÑÑ‚Ğ°Ñ” user_id
    user_id = payload['user_id']  # 3
    
    # 5. Ğ¡Ñ‚Ğ²Ğ¾Ñ€ÑÑ” "Ñ„ĞµĞ¹ĞºĞ¾Ğ²Ğ¸Ğ¹" User Ğ¾Ğ±'Ñ”ĞºÑ‚
    request.user = AnonymousUser()
    request.user.id = user_id
    request.user.is_authenticated = True
    
except jwt.ExpiredSignatureError:
    return Response({"error": "Token expired"}, status=401)
except jwt.InvalidTokenError:
    return Response({"error": "Invalid token"}, status=401)


```
---

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¾Ğ±Ğ¾Ñ… ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ²:

### **Ğ’Ğ°Ñ€Ñ–Ğ°Ğ½Ñ‚ 1: Ğ’Ñ€ÑƒÑ‡Ğ½Ñƒ (Ğ´Ğ²Ğ° Ñ‚ĞµÑ€Ğ¼Ñ–Ğ½Ğ°Ğ»Ğ¸)**

```bash
# Ğ¢ĞµÑ€Ğ¼Ñ–Ğ½Ğ°Ğ» 1: Auth Service
cd auth_service
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver 8001

# Ğ¢ĞµÑ€Ğ¼Ñ–Ğ½Ğ°Ğ» 2: Books Service
cd books_service
python manage.py migrate
python manage.py runserver 8002
```

### **Ğ’Ğ°Ñ€Ñ–Ğ°Ğ½Ñ‚ 2: Docker Compose (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒÑ)**

**`docker-compose.yml`:**

```yaml
version: '3.8'

services:
  auth_service:
    build: ./auth_service
    ports:
      - "8001:8000"
    environment:
      - JWT_SECRET_KEY=super-secret-key-123
      - JWT_ALGORITHM=HS256
    volumes:
      - ./auth_service:/app
    command: python manage.py runserver 0.0.0.0:8000

  books_service:
    build: ./books_service
    ports:
      - "8002:8000"
    environment:
      - JWT_SECRET_KEY=super-secret-key-123  # âš ï¸ Ğ¢Ğ¾Ğ¹ ÑĞ°Ğ¼Ğ¸Ğ¹!
      - JWT_ALGORITHM=HS256
      - AUTH_SERVICE_URL=http://auth_service:8000
    volumes:
      - ./books_service:/app
    depends_on:
      - auth_service
    command: python manage.py runserver 0.0.0.0:8000
```

**Ğ—Ğ°Ğ¿ÑƒÑĞº:**
```bash
docker-compose up
```

---

## ğŸ§ª Ğ¢ĞµÑÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ:

```bash
# 1. Ğ ĞµÑ”ÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ
curl -X POST http://localhost:8001/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "SecurePass123!",
    "password2": "SecurePass123!"
  }'

# 2. ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ Ñ‚Ğ¾ĞºĞµĞ½Ñƒ
TOKEN=$(curl -X POST http://localhost:8001/api/auth/token/ \
  -H "Content-Type: application/json" \
  -d '{"username": "testuser", "password": "SecurePass123!"}' \
  | jq -r '.access')

echo "Token: $TOKEN"

# 3. Ğ¡Ñ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ ĞºĞ½Ğ¸Ğ³Ğ¸ (Books Service Ğ²Ğ°Ğ»Ñ–Ğ´ÑƒÑ” Ñ‚Ğ¾ĞºĞµĞ½!)
curl -X POST http://localhost:8002/api/books/ \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "ĞšĞ¾Ğ±Ğ·Ğ°Ñ€",
    "author": "Ğ¢Ğ°Ñ€Ğ°Ñ Ğ¨ĞµĞ²Ñ‡ĞµĞ½ĞºĞ¾",
    "genre": "ĞŸĞ¾ĞµĞ·Ñ–Ñ",
    "publication_year": 1840
  }'

# 4. ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ğ½Ğ½Ñ ĞºĞ½Ğ¸Ğ³Ğ¸ Ğ· Ñ–Ğ½Ñ„Ğ¾ Ğ¿Ñ€Ğ¾ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°
curl -X GET http://localhost:8002/api/books/1/with_user_info/ \
  -H "Authorization: Bearer $TOKEN"
```

---
